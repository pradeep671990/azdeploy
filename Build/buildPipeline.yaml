name: $(BuildDefinitionName)_$(SourceBranchName)_$(date:yyyyMMdd)$(rev:.r)
queue: Hosted VS2017
trigger:
  - main
variables:
  SourceFolder: 'Deployment'
  DeploymentProjectFolder: 'Deployment/Artifacts'
steps:
- task: Npm@1
  displayName: 'npm: Install JSON Lint'
  inputs:
    command: custom
    verbose: false
    customCommand: 'install jsonlint -g'
- powershell: 'gci -Filter *.json -Recurse -File | % { Write-Host "`nLinting $($_.FullName)`n"; jsonLint $_.FullName }'
  displayName: 'Run jsonLint'
  failOnStderr: true
  workingDirectory: '$(DeploymentProjectFolder)'
- task: CopyFiles@2
  displayName: 'Copy Files to: Artifact Staging Directory'
  inputs:
    SourceFolder: '$(SourceFolder)'
    TargetFolder: '$(Build.ArtifactStagingDirectory)'
- task: PublishBuildArtifacts@1
  displayName: 'Publish Artifact: drop'
